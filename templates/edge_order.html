{% extends "edge_base.html" %}
{% load static %}
{% block title %} Lepos London | Order {% endblock title %}
{% block css %}
<style>
</style>
{% endblock css %}
{% block body %}
    <section class="order-page">

        <div class="order-wrp">
            <form class="order-form" method="post">{% csrf_token %}
                <div class="order-left">
                    <h2 class="logo">BILLING INFORMATION</h2>
                        <p>Contact information</p>
                        <div class="row">
                            <div class="col-lg-6">
                                <div class="mb-3">
                                    <label for="" class="form-label">First name</label>
                                    <input name="first_name" type="text" class="form-control" id="first_name" placeholder="" aria-describedby="" value="{{user_data.first_name}}"  required />
                                </div>
                            </div>
                            <div class="col-lg-6">
                                <div class="mb-3">
                                    <label for="" class="form-label">Last name</label>
                                    <input name="last_name" type="text" class="form-control" id="last_name" placeholder="" aria-describedby="" value="{{user_data.last_name}}"  required />
                                </div>
                            </div>
                            <div class="col-lg-12">
                                <div class="mb-3">
                                    <label for="exampleInputEmail1" class="form-label">Email address</label>
                                    <input name="email" type="email" class="form-control" id="exampleInputEmail1" placeholder="Email"
                                        aria-describedby="emailHelp" value="{{user_data.email}}"  required />
                                </div>
                            </div>

                            <div class="col-lg-12">
                                <div class="mb-3">
                                    <label for="" class="form-label">Phone</label>
                                    <input name="contact_number" id="contact_number" type="text" class="form-control" placeholder="" aria-describedby="" value="{{user_data.contact_number}}"  required />
                                </div>
                            </div>
                            <div class="col-lg-12">
                                <div class="mb-3">
                                    <label for="" class="form-label">Address</label>
                                    <input name="address" id="address" type="text" class="form-control" placeholder="" aria-describedby="" value="{{add_data.address}}"  required />
                                </div>
                            </div>
                            <div class="col-lg-6">
                                <div class="mb-3">
                                    <label for="" class="form-label">City</label>
                                    <input name="city" id="city" type="text" class="form-control" placeholder="" aria-describedby="" value="{{add_data.city}}"  required />
                                </div>
                            </div>
                            <div class="col-lg-6">
                                <div class="mb-3">
                                    <label for="" class="form-label">Zip / Postcode</label>
                                    <input name="pincode" id="pincode" type="text" class="form-control" placeholder="" aria-describedby="" value="{{add_data.pincode}}"  required />
                                </div>
                            </div>
                            <div class="col-lg-6">
                                <div class="mb-3">
                                    <label for="" class="form-label">State</label>
                                    <input name="state" id="state" type="text" class="form-control" placeholder="" aria-describedby="" value="{{add_data.state}}"  required />
                                </div>
                            </div>
                            <div class="col-lg-6">
                                <div class="mb-3">
                                    <label for="" class="form-label">Country</label>
                                    <input name="country" id="country" type="text" class="form-control" placeholder="" aria-describedby="" value="{{add_data.country}}"  required />
                                </div>
                            </div>
                        </div>

                </div>
                <div class="order-right">
                    <div class="product-bill-total">
                        <ul>
                            <li>
                                <h3>PRODUCT</h3>
                                <h3>TOTAL</h3>
                            </li>
                            {% for row in cartitem_data %}
                            <li>
                                <input type="hidden" id="ids" name="ids[]" value="{{row.product.id}}">
                                <input type="hidden" id="qty" name="qty[]" value="{{row.quantity}}">
                                <input type="hidden" id="size" name="size[]" value="{{row.size}}">
                                <input type="hidden" id="unite_price" name="unit_price[]" value="{{row.unit_price}}">
                                
                                <div class="product-items">
                                    <p>{{row.product}} * {{row.quantity}}</p>
                                    <p>£ {{row.unit_price}}</p>
                                </div>
                            </li>
                            {% endfor %}
                            <input type="hidden" name="total_price" value="{{grand_total}}">
                            <input type="hidden" name="sub_total" value="{{total}}">
                            <input type="hidden" name="order_id" value="{{order_id.id}}">
                            <li>
                                <span>Cart Subtotal	</span>
                                <span>£ {{total}}</span>
                            </li>
                            <li>
                                <span>(+) Shipping Charge	</span>
                                <span>Free</span>
                            </li>
                            <li>
                                <h2>TOTAL</h2>
                                <h2 class="price">£ {{grand_total}}</h2>
                            </li>
                        </ul>
                        <p>Your personal data will be used to process your order, support your experience throughout this website, and for other purposes described in our privacy policy.</p>
                        <div class="mb-3 form-check terms">
                            <input type="checkbox" class="form-check-input" id="exampleCheck1">
                            <label class="form-check-label" for="exampleCheck1">I have read and agree to the website <a class="my_terms_conditions"
                                                href="{% url 'terms_conditions' %}">terms and
                                                conditions</a></label>
                        </div>
                        <div class="payment-button">
                            <button class="button is-primary" id="submitBtn">Purchase!</button>
                            <button type="submit" class="payment-btn">COD (Cash On Delivery)</button>
                            {% comment %} <button type="submit" name="razorpay" class="payment-btn razorpay">Pay</button> {% endcomment %}
                            <div id="paypal-button-container"></div>
                        </div>
                    </div>
                </div>
            </form>

        </div>

    </section>
{% endblock body %}

{% block script %}
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
<script src="https://www.paypal.com/sdk/js?client-id=AdMyHawyFjmfOKQSWnYre4S6QnaVQ77rdXIi5pbTXSSP0cn6g7x5dwENGtiHfnsTh9f1NswJ_-nHfIV9&currency=USD"></script>
    <!-- Include the PayPal JavaScript SDK -->
    <script src="https://www.paypal.com/sdk/js?client-id=test&currency=USD"></script>

    <script>
        // Render the PayPal button into #paypal-button-container
        paypal.Buttons({

            // Set up the transaction
            createOrder: function(data, actions) {
                return actions.order.create({
                    purchase_units: [{
                        amount: {
                            value: '88.44'
                        }
                    }]
                });
            },

            // Finalize the transaction
            onApprove: function(data, actions) {
                return actions.order.capture().then(function(orderData) {
                    // Successful capture! For demo purposes:
                    console.log('Capture result', orderData, JSON.stringify(orderData, null, 2));
                    var transaction = orderData.purchase_units[0].payments.captures[0];
                    alert('Transaction '+ transaction.status + ': ' + transaction.id + '\n\nSee console for all available details');

                    // Replace the above to show a success message within this page, e.g.
                    // const element = document.getElementById('paypal-button-container');
                    // element.innerHTML = '';
                    // element.innerHTML = '<h3>Thank you for your payment!</h3>';
                    // Or go to another URL:  actions.redirect('thank_you.html');
                });
            }


        }).render('#paypal-button-container');
    </script>
<script src="{% static 'js/pay.js' %}"></script>

{% endblock script %}